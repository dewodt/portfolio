---
import { Image } from "astro:assets";
import { getFormattedDate } from "@/lib/utils";
import type { AllAwardsQueryResult } from "@/types/sanity";
import CardDescription from "./shared/CardDescription.astro";
import CardMetaDate from "./shared/CardMetaDate.astro";
import CardMonoLabel from "./shared/CardMonoLabel.astro";
import CardTitle from "./shared/CardTitle.astro";

interface Props {
  award: AllAwardsQueryResult[number];
}

const { award } = Astro.props;

const formattedDate = getFormattedDate(award.date);
---

<article
  class="group/card border-border bg-card hover:drop-shadow-primary relative h-full overflow-hidden rounded-xl border transition-all duration-300 hover:-translate-y-1.5"
>
  {/* Gradient glow pseudo-element */}
  <div
    class="bg-primary/0 group-hover/card:bg-primary/10 dark:group-hover/card:bg-primary/15 pointer-events-none absolute -inset-px -z-10 rounded-xl blur-xl transition-all duration-500"
  >
  </div>

  {/* Full-card anchor */}
  <a
    href={`/awards/${award.slug.current}`}
    aria-label={`Link to award ${award.title} issued by ${award.issuer}`}
    class="absolute inset-0 z-30"></a>

  <div class="flex h-full flex-col sm:flex-row">
    {/* Image â€” 1:1 square logo */}
    <div
      class="bg-muted border-border relative overflow-hidden border-b transition-colors duration-300 sm:w-1/3 sm:border-r sm:border-b-0"
    >
      <Image
        class="bg-muted text-muted-foreground flex aspect-video w-full items-center justify-evenly object-cover object-center text-base font-medium transition-transform duration-700 group-hover/card:scale-[1.03] sm:absolute sm:inset-0 sm:h-full"
        src={award.image.url!}
        alt={award.image.alt}
        widths={[320, 384, 640, 768]}
        sizes="(max-width: 639px) 100vw, 280px"
        inferSize
      />
    </div>

    {/* Content */}
    <div class="flex flex-1 flex-col p-4 lg:p-5">
      {/* Issuer mono label */}
      <CardMonoLabel class="mb-0.5">{award.issuer}</CardMonoLabel>

      {/* Title + arrow */}
      <CardTitle class="mb-1">{award.title}</CardTitle>

      {/* Date */}
      <CardMetaDate date={award.date} class="mb-2">{formattedDate}</CardMetaDate
      >

      {/* Description */}
      <CardDescription class="line-clamp-3">{award.description}</CardDescription
      >
    </div>
  </div>
</article>
