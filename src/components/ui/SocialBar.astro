---
import { sanityClient, socialsQuery } from "@/lib/query";
import type { SocialsQueryResult } from "@/types/sanity";

const data = await sanityClient.fetch<SocialsQueryResult>(socialsQuery);
const socialLinks = (data?.socialLinks ?? []).filter(
  (link) => link.iconLight || link.iconDark,
);
---

<!-- Bottom blur -->
<div
  class="dark:from-background pointer-events-none fixed inset-x-0 bottom-0 z-30 block h-16 w-full bg-linear-to-t from-black/30 to-transparent backdrop-blur-lg [-webkit-mask-image:linear-gradient(to_top,black,transparent)]"
>
</div>

<!-- Bar -->
<!-- Note: When using sticky bottom the anchor link is misplaced in mobile firefox (because of the top search browser bar). Alternatively, use fixed with margin to overcome this issue.-->
<ul
  class="social-dock border-border/80 bg-card/80 fixed bottom-4 left-1/2 z-30 flex -translate-x-1/2 flex-row items-center justify-center gap-2 rounded-full border p-1.5 backdrop-blur-xl transition-[gap] duration-300 ease-out hover:gap-3"
>
  {
    socialLinks.map((social) => (
      <li class="social-dock-item">
        <a
          href={social.url}
          aria-label={social.name}
          target="_blank"
          class="group text-foreground flex size-10 rounded-full p-1.5"
        >
          <img
            class="size-full dark:hidden"
            src={social.iconLight!}
            alt={social.name}
          />
          <img
            class="hidden size-full dark:block"
            src={social.iconDark!}
            alt={social.name}
          />
        </a>
      </li>
    ))
  }
</ul>

<style>
  .social-dock-item {
    transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);
  }

  .social-dock-item:hover {
    transform: scale(1.35);
  }

  .social-dock-item:hover + .social-dock-item,
  .social-dock-item:has(+ .social-dock-item:hover) {
    transform: scale(1.125);
  }

  .social-dock-item:hover + .social-dock-item + .social-dock-item,
  .social-dock-item:has(+ .social-dock-item + .social-dock-item:hover) {
    transform: scale(1.05);
  }
</style>
