---
import LayoutBase from "@/layouts/LayoutBase.astro";
import type { AllBlogsQueryResult, BlogPageQueryResult } from "@/types/sanity";
import { sanityClient, allBlogsQuery, blogPageQuery } from "@/lib/query";
import CardBlog from "@/components/ui/card/CardBlog.astro";

// Get blogs page from CMS
const blogPageData =
  await sanityClient.fetch<BlogPageQueryResult>(blogPageQuery);

// Get all blogs from CMS
const allBlogData =
  await sanityClient.fetch<AllBlogsQueryResult>(allBlogsQuery);

if (!blogPageData) {
  throw new Error("Failed to fetch blogs page data");
}
---

<LayoutBase
  title={`${blogPageData.title} | Dewantoro Triatmojo`}
  description={blogPageData.description}
>
  <main class="flex flex-auto justify-center px-5 py-10 sm:p-12 lg:p-16">
    <section
      class="flex w-full max-w-3xl flex-col items-center gap-8 lg:gap-10"
    >
      {/* Header */}
      <div class="flex flex-col text-center">
        <span
          class="text-primary animate-fade-in-up mb-1 font-mono text-xs tracking-widest uppercase lg:mb-2 lg:text-sm"
          style="animation-delay: 0.1s;"
        >
          {blogPageData.monoLabel}
        </span>
        <h1
          class="text-secondary animate-fade-in-up mb-2 text-3xl font-bold lg:mb-3 lg:text-5xl"
          style="animation-delay: 0.2s;"
        >
          {blogPageData.title}
        </h1>
        <p
          class="text-muted animate-fade-in-up text-base lg:text-lg"
          style="animation-delay: 0.3s;"
        >
          {blogPageData.description}
        </p>
      </div>

      {/* Blog Grid */}
      <ul
        class="mx-auto grid w-full max-w-sm grid-cols-1 gap-6 sm:max-w-none lg:gap-8"
      >
        {
          allBlogData.map((blog, index) => (
            <li
              class="animate-fade-in-up"
              style={`animation-delay: ${0.4 + index * 0.1}s;`}
            >
              <CardBlog blog={blog} />
            </li>
          ))
        }
      </ul>
    </section>
  </main>
</LayoutBase>
