---
import "../styles/global.css";
import Navbar from "@/components/ui/Navbar.astro";
import SocialBar from "@/components/ui/SocialBar.astro";
import Head from "@/components/head/Head.astro";

interface Props {
  title: string;
  description: string;
  linkPreviewImage?: {
    url: string | null;
    alt: string;
  };
}

const { title, description, linkPreviewImage } = Astro.props;
---

<!doctype html>
<html lang="en">
  {/* Common Head */}
  <Head
    title={title}
    description={description}
    linkPreviewImage={linkPreviewImage}
  />

  {/* Body Content */}
  <body
    class="bg-background flex min-h-screen flex-col pt-[74px] pb-[78px] font-sans antialiased sm:pt-[66px]"
  >
    {/* Navbar */}
    <Navbar />

    {/* Content */}
    <slot />

    {/* Footer */}
    <SocialBar />

    {/* Scroll-triggered animations */}
    <script>
      const prefersReducedMotion = window.matchMedia(
        "(prefers-reduced-motion: reduce)",
      ).matches;

      const els = document.querySelectorAll<HTMLElement>("[data-scroll]");

      if (prefersReducedMotion) {
        els.forEach((el) => (el.style.opacity = "1"));
      } else {
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                const type = (entry.target as HTMLElement).dataset.scroll!;
                entry.target.classList.add(`animate-${type}`);
                observer.unobserve(entry.target);
              }
            });
          },
          { threshold: 0.1 },
        );
        els.forEach((el) => observer.observe(el));
      }
    </script>
  </body>
</html>
